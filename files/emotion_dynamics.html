<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Emotional Dynamics Simulator</title>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
<h1>Interactive Emotional Dynamics Simulator</h1>
<div>
  <label>Intensity (mean μ): <input type="range" id="intensity" min="-2" max="2" value="0" step="0.1"></label>
  <span id="intensityVal">0</span>
  <br>
  <label>Inertia (φ): <input type="range" id="inertia" min="-0.99" max="0.99" value="0.5" step="0.01"></label>
  <span id="inertiaVal">0.5</span>
  <br>
  <label>Variability (σ): <input type="range" id="variability" min="0.1" max="2" value="0.5" step="0.1"></label>
  <span id="variabilityVal">0.5</span>
  <br>
  <label>Days: <input type="number" id="days" min="10" max="365" value="60"></label>
  <button onclick="simulate()">Regenerate</button>
</div>
<div id="plot"></div>
<script>
function ar1Simulation(mu, phi, sigma, n, y0=0) {
  let y = [y0];
  for (let t=1; t<n; t++) {
    let eps = sigma * gaussianRandom();
    y.push(mu + phi*(y[t-1]-mu) + eps);
  }
  return y;
}

function gaussianRandom() {
  let u = 0, v = 0;
  while(u === 0) u = Math.random();
  while(v === 0) v = Math.random();
  return Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);
}

function simulate() {
  let mu = parseFloat(document.getElementById('intensity').value);
  let phi = parseFloat(document.getElementById('inertia').value);
  let sigma = parseFloat(document.getElementById('variability').value);
  let days = parseInt(document.getElementById('days').value);
  
  document.getElementById('intensityVal').innerText = mu;
  document.getElementById('inertiaVal').innerText = phi;
  document.getElementById('variabilityVal').innerText = sigma;

  let series = ar1Simulation(mu, phi, sigma, days, mu);
  let trace = {
    x: [...Array(days).keys()].map(d => d+1),
    y: series,
    mode: 'lines+markers',
    name: 'Simulated Affect'
  };
  Plotly.newPlot('plot', [trace], {title: 'Daily Affect Simulation', xaxis: {title: 'Day'}, yaxis: {title: 'Affect'}});
}

simulate();
</script>
</body>
</html>
